doctype html
html
  head
    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width, initial-scale=1, maximum-scale=1')
    title REST with Node.js

    // build:css styles/styles.css
    //- Check out 'src/bower_components/prism/themes/' for available themes
    link(rel='stylesheet', type='text/css', href='bower_components/prism/themes/prism-tomorrow.css')
    link(rel='stylesheet', type='text/css', href='styles/main.css')
    // endbuild

  body

    div#folder-structure
      h5 Open Files
      h5 Folders
      ul noderest
        li server.js
        li.package-json package.json 
        li.node-modules
          ul node_modules 
            li express
        li.routes-js routes.js
        li.controllers
          ul controllers
            li snacks.js

    div#terminal
      ul
        li $ cd noderest/
        li $ node server.js
        li Server running at http://127.0.0.1:3001/
        li $ npm install
        li 
          span.synt-hi-node npm
          &nbsp;
          span.synt-hi-http http
          &nbsp;
          span.synt-hi-prot GET 
          span https://registry.npmjs.org/express
        li 
          span.synt-hi-node npm
          &nbsp;
          span.synt-hi-http http
          &nbsp;
          span.synt-hi-prot 200 
          span https://registry.npmjs.org/express
        li express@3.5.2 node_modules/express
        li ├── methods@0.1.0
        li ├── merge-descriptors@0.0.2
        li ├── cookie@0.1.2
        li ├── cookie-signature@1.0.3
        li ├── range-parser@1.0.0
        li ├── debug@0.8.1
        li ├── fresh@0.2.2
        li ├── buffer-crc32@0.2.1
        li ├── mkdirp@0.4.0
        li ├── commander@1.3.2 (keypress@0.1.0)
        li ├── send@0.3.0 (debug@0.8.0, mime@1.2.11)
        li └── connect@2.14.5 (response-time@1.0.0, pause@0.0.1, connect-timeout@1.0.0, method-override@1.0.0, qs@0.6.6, basic-auth-connect@1.0.0, vhost@1.0.0, bytes@0.3.0, raw-body@1.1.4, static-favicon@1.0.2, errorhandler@1.0.0, setimmediate@1.0.1, serve-static@1.1.0, morgan@1.0.0, csurf@1.1.0, cookie-parser@1.0.1, compression@1.0.0, express-session@1.0.2, serve-index@1.0.1, multiparty@2.2.0)
        li $
        li $ node server.js
        li Listening on port 3001...        
        li $
        li $ node server.js
        li Listening on port 3001...

    article

      section(data-bespoke-state='title')
        h1 REST with Node.js

      section(data-bespoke-state='intro')
        h2 Mental Map
        h3 REST + Node.js?

      section(data-bespoke-state='intro')
        h2 REST + PHP
        ul
          li 
          li Apache
          li .php controllers
          li .htaccess pretty urls
          li Content-Type JSON Headers
          li MySQLi 

      section(data-bespoke-state='intro')
        h2 REST + Nodejs
        ul
          li 
          li Node.js
          li Express
          li JavaScript modules
          li Routes
          li Mongo

      section(data-bespoke-state='server')
        h2 Node.js
        h3 server.js
        hr
        pre
          code.language-javascript.
            var http = require('http');
            http.createServer(function (req, res) {
              res.writeHead(200, {'Content-Type': 'text/plain'});
              res.end('Hello World\n');
            }).listen(3001, '127.0.0.1');
            console.log('Server running at http://127.0.0.1:3001/');

      section#npm-install(data-bespoke-state='node')
        h2 Node.js 
        h3 Terminal command
        hr
        pre
          code.language-javascript.
            $ cd noderest/
            $ node server.js

      section#npm-install(data-bespoke-state='node')
        h2 Node.js 
        h3 start node

      section(data-bespoke-state='node')
        h2 Node.js
        h3 server started
        hr
        img(src="img/browser-node.gif",height="282",width="394")

      section#package-json(data-bespoke-state='express')
        h2 Add Dependencies
        h3 Express: App Framework for Node
        h3 package.json
        hr
        pre
          code.language-javascript.
            {
                "name": "Node REST Demo",
                "description": "Demo REST API with Node",
                "version": "0.0.1",
                "private": true,
                "dependencies": {
                    "express": "3.x"
                }
            }

      section(data-bespoke-state='express')
        h2 Install Dependencies
        h3 Express is only dependency
        hr
        pre
          code.language-javascript.
            $ npm install

      section(data-bespoke-state='node')
        h2 Express
        h3 installing

      section(data-bespoke-state='server')
        h2 Add Express
        h3 server.js
        hr
        pre
          code.language-javascript.
            var express = require('express');
 
            var app = express();
             
            app.get('/', function(req, res) {
                res.send('Hello World\n');
            });

            app.listen(3001);
            console.log('Listening on port 3001...');

      section(data-bespoke-state='express')
        h2 Express
        h3 restart Node with Express
        pre 
          code.language-javascript.
            CTRL+C

      section(data-bespoke-state='express')
        h2 Node and Express
        h3 serving different headers
        img(src="img/browser-express.gif",height="282",width="394")

      section(data-bespoke-state='express')
        h2 Routes
        hr
        pre
          code.language-javascript.
            app.get('/path', function(req, res) {
                res.send('Return JSON or HTML View');
            });

      section(data-bespoke-state='express')
        h2 Request
        h3 req
        hr
        pre
          code.language-javascript.
            app.get('/snack/:brand', function(req, res) {

                // Get /snack/nabisco
                console.log(req.params.brand)
                // => nabisco

                res.send('{"id": 1,"brand": "nabisco","products": 
                  [{"id": 1, "name": "oreo"}]}');
            });

      section(data-bespoke-state='express')
        h2 Response
        h3 res
        hr
        pre
          code.language-javascript.
            res.send({ some: 'json' });
            res.send('html for oreo page');
            res.send(404, 'No snacks here');
            res.send(500, { error: 'you blew it' });
            res.send(200);

      section(data-bespoke-state='express')
        h2 HTTP verbs
        h3 routes.js
        hr
        pre
          code.language-javascript.
            module.exports = function(app){
              var snacks = require('./controllers/snacks');

              app.get('/snacks', snacks.findAll);
              app.get('/snacks/:id', snacks.findById);
              app.post('/snacks', snacks.add);
              app.put('/snacks/:id', snacks.update);
              app.delete('/snacks/:id', snacks.delete);
            }

      section(data-bespoke-state='express')
        h2 JS Modules
        h3 controllers/snacks.js
        hr
        pre
          code.language-javascript.
            exports.findAll = function(req, res){
              res.send({
                "id": 1,
                "brand": "nabisco",
                "products": [{"id": 1,"name": "oreo"}]
              });
            };

      section(data-bespoke-state='server')
        h2 Import Routes and JS Modules
        h3 server.js
        hr
        pre
          code.language-javascript.
            var express = require('express');
 
            var app = express();             
            
            require('routes')(app);

            app.listen(3001);
            console.log('Listening on port 3001...');

      section(data-bespoke-state='express')
        h2 Node.js
        h3 restart node server
        pre 
          code.language-javascript.
            CTRL+C

      section(data-bespoke-state='express')
        h2 REST GET
        h3 /snacks
        img(src="img/browser-snacks.gif",height="282",width="394")

      section(data-bespoke-state='express')
        h2 Mongo DB
        h3 controllers/snacks.js
        hr
        pre
          code.language-javascript.
            var mongoose = require('mongoose'),
            Snack = mongoose.model('Snack');
          
            exports.findAll = function(req, res){
              Snack.find({},function(err, results) {
                return res.send(results);
              });
            };



            

      section(data-bespoke-state='express')
        h2 Credits
        a(href="http://expressjs.com/4x/api.html") Express API Reference
        a(href="http://coenraets.org/blog/2012/10/creating-a-rest-api-using-node-js-express-and-mongodb/") Creating a REST API using Node.js, Express, and MongoDB
        a(href="https://github.com/markdalgleish/bespoke.js") Bespoke.js
        a(href="http://blog.dfilimonov.com/2013/09/12/devtools-terminal.html") Devtools Terminal


        

    script(src="//use.typekit.net/eag8wad.js")
    // build:js scripts/scripts.js
    script(src='bower_components/bespoke.js/dist/bespoke.min.js')
    script(src='bower_components/bespoke-keys/dist/bespoke-keys.min.js')
    script(src='bower_components/bespoke-touch/dist/bespoke-touch.min.js')
    script(src='bower_components/bespoke-bullets/dist/bespoke-bullets.min.js')
    script(src='bower_components/bespoke-scale/dist/bespoke-scale.min.js')
    script(src='bower_components/bespoke-hash/dist/bespoke-hash.min.js')
    script(src='bower_components/bespoke-progress/dist/bespoke-progress.min.js')
    script(src='bower_components/bespoke-state/dist/bespoke-state.min.js')
    script(src='bower_components/bespoke-forms/dist/bespoke-forms.min.js')
    script(src='bower_components/prism/prism.js')
    script(src='scripts/main.js')
    // endbuild